<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.93.2" />
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>24th Hackingcamp Ctf :: </title>

    
    <link href="/css/nucleus.css?1647877931" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1647877931" rel="stylesheet">
    <link href="/css/hybrid.css?1647877931" rel="stylesheet">
    <link href="/css/featherlight.min.css?1647877931" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1647877931" rel="stylesheet">
    <link href="/css/auto-complete.css?1647877931" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1647877931" rel="stylesheet">
    <link href="/css/theme.css?1647877931" rel="stylesheet">
    <link href="/css/tabs.css?1647877931" rel="stylesheet">
    <link href="/css/hugo-theme.css?1647877931" rel="stylesheet">
    
    <link href="/css/theme-custom.css?1647877931" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1647877931"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/ctf/2020/24th-hackingcamp-ctf/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://o_o.jseung.me/">
   <img src="/images/jseung.png" alt="jseung.png">
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1647877931"></script>
<script type="text/javascript" src="/js/auto-complete.js?1647877931"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/o_o.jseung.me\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1647877931"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/ctf/" title="CTF" class="dd-item
        parent
        
        
        ">
      <a href="/ctf/">
          <b>üö© </b>CTF
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ctf/2020/vishwactf/" title="2022 Vishwactf" class="dd-item ">
        <a href="/ctf/2020/vishwactf/">
        2022 Vishwactf
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ctf/2020/24th-hackingcamp-ctf/" title="24th Hackingcamp Ctf" class="dd-item active">
        <a href="/ctf/2020/24th-hackingcamp-ctf/">
        24th Hackingcamp Ctf
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/cve/" title="CVE" class="dd-item
        
        
        
        ">
      <a href="/cve/">
          <b>ü§† </b>CVE
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/tech/" title="HACKING TECHNIQUE" class="dd-item
        
        
        
        ">
      <a href="/tech/">
          <b>üëª  </b>HACKING TECHNIQUE
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/tech/web/" title="web" class="dd-item
        
        
        
        ">
      <a href="/tech/web/">
          <b>0x01. </b>web
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/pwn/" title="pwn" class="dd-item
        
        
        
        ">
      <a href="/tech/pwn/">
          <b>0x02. </b>pwn
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/rev/" title="rev" class="dd-item
        
        
        
        ">
      <a href="/tech/rev/">
          <b>0x03. </b>rev
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/crypto/" title="crypto" class="dd-item
        
        
        
        ">
      <a href="/tech/crypto/">
          <b>0x04. </b>crypto
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/mobile/" title="mobile" class="dd-item
        
        
        
        ">
      <a href="/tech/mobile/">
          <b>0x05. </b>mobile
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/forensic/" title="forensic" class="dd-item
        
        
        
        ">
      <a href="/tech/forensic/">
          <b>0x06. </b>forensic
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/hardware/" title="hardware" class="dd-item
        
        
        
        ">
      <a href="/tech/hardware/">
          <b>0x07. </b>hardware
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/network/" title="network" class="dd-item
        
        
        
        ">
      <a href="/tech/network/">
          <b>0x08. </b>network
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/tech/network/bgp-hijacking/" title="BGP Hijacking" class="dd-item ">
        <a href="/tech/network/bgp-hijacking/">
        BGP Hijacking
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://jseung.me"> Jaeseung Lee üëª</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/g0pher98"><i class='fab fa-github'></i>  Github</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                    
                  <span id="toc-menu"><i class="fas fa-list-alt"></i> INDEX</span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'></a> > <a href='/ctf/'>CTF</a> > 24th Hackingcamp Ctf
          
        
          
        
          
        
                 
                  </span>
                  
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#web">WEB</a>
      <ul>
        <li><a href="#basic-auth">Basic Auth</a></li>
        <li><a href="#Ìï©Í≤©Ïûê-Î∞úÌëú">Ìï©Í≤©Ïûê Î∞úÌëú</a></li>
      </ul>
    </li>
    <li><a href="#crypto">CRYPTO</a>
      <ul>
        <li><a href="#really-safe-a">Really Safe A,,,</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              24th Hackingcamp Ctf
            </h1>
          

        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

<h2 id="web">WEB</h2>
<h3 id="basic-auth">Basic Auth</h3>
<blockquote>
<p>Ïñ¥ÎîîÎ°úÎì† Î¨∏~~~ ÏùÄ Ïû†Í≤®ÏûàÏäµÎãàÎã§. Ïó¥Ïá†Í∞Ä ÌïÑÏöîÌïòÏã†Í∞ÄÏöî?</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#! /usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> request, url_for
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> wraps
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flag <span style="color:#f92672">import</span> FLAG 
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os<span style="color:#f92672">,</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>server <span style="color:#f92672">=</span> Flask(__name__)
</span></span><span style="display:flex;"><span>server<span style="color:#f92672">.</span>secret_key <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>urandom(<span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_auth</span>(f):
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@wraps</span>(f)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">func</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>        page <span style="color:#f92672">=</span> kwargs[<span style="color:#e6db74">&#39;page&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> page<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;.&#39;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#39;js&#39;</span>, <span style="color:#e6db74">&#39;css&#39;</span>, <span style="color:#e6db74">&#39;png&#39;</span>, <span style="color:#e6db74">&#39;jpg&#39;</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            auth <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>authorization
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> (auth <span style="color:#f92672">and</span> check_login(auth<span style="color:#f92672">.</span>username, auth<span style="color:#f92672">.</span>password)):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> (<span style="color:#e6db74">&#39;Wrong! who are you???üòë&#39;</span>, <span style="color:#ae81ff">401</span>, {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;WWW-Authenticate&#39;</span>: <span style="color:#e6db74">&#39;Basic realm=&#34;show me your id,pw&#34;&#39;</span>
</span></span><span style="display:flex;"><span>                })
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> func
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_login</span>(user_id, user_pw):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(url_for(<span style="color:#e6db74">&#39;static&#39;</span>, filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;account&#39;</span>)[<span style="color:#ae81ff">1</span>:], <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;:&#39;</span>)
</span></span><span style="display:flex;"><span>        admin_id <span style="color:#f92672">=</span> data[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        admin_pw <span style="color:#f92672">=</span> data[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> user_id <span style="color:#f92672">==</span> admin_id <span style="color:#f92672">and</span> user_pw <span style="color:#f92672">==</span> admin_pw:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@server</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Welcome! go to any page!&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@server</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#39;/&lt;page&gt;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@check_auth</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">flag</span>(page):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;.&#39;</span> <span style="color:#f92672">in</span> page:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> server<span style="color:#f92672">.</span>send_static_file(page)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> FLAG
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    server<span style="color:#f92672">.</span>run(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;0.0.0.0&#39;</span>)
</span></span></code></pre></div><p>Î¨∏Ï†ú ÏΩîÎìúÎ•º Î≥¥Î©¥ Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ ÌõÑ dot(.)Ïù¥ ÏóÜÎäî <code>/&lt;page&gt;</code> Ï¶â, ÏïÑÎ¨¥ ÌéòÏù¥ÏßÄÎÇò Ï†ëÍ∑ºÌïòÎ©¥ ÌîåÎûòÍ∑∏Î•º Ï£ºÎäî Í≤ÉÏùÑ Ïïå Ïàò ÏûàÎã§. Í∑∏Îü¨ÎÇò Ïã§Ï†úÎ°ú Ï†ëÍ∑ºÌï¥Î≥¥Î©¥ <code>check_auth()</code> decorator functionÏóê ÏùòÌï¥ HTTP Basic AuthenticationÏùÑ ÏöîÍµ¨Ìï®ÏùÑ Ïïå Ïàò ÏûàÎã§. Basic AuthenticationÏóê ÏÇ¨Ïö©ÎêòÎäî Í≥ÑÏ†ïÏùÄ <code>/static/account</code>Ïóê Ï°¥Ïû¨ÌïòÎ©∞, Ï†ëÍ∑º Ïãú Í∑∏ ÎÇ¥Ïö©ÏùÄ ÏïÑÎûòÏôÄ Í∞ôÎã§.</p>
<pre tabindex="0"><code>ThisIsNotFlagJustAdminID:ThisIsNotFlagJustAdminPassword
</code></pre><p>ÏúÑ ÎÇ¥Ïö©ÏùÑ Ïù¥Ïö©Ìï¥ÏÑú Basic Authentication Ïù∏Ï¶ùÏùÑ ÏãúÎèÑÌïòÎ©¥ Î°úÍ∑∏Ïù∏Ïù¥ ÏßÑÌñâÎêòÏßÄ ÏïäÎäîÎã§. account ÌååÏùºÏóê Ï†ëÍ∑ºÌï† Îïå ÏÇ¨Ïö©Ìïú <code>url_for</code> Ìï®ÏàòÍ∞Ä webrootÎ•º Í∏∞Î∞òÏúºÎ°ú Ìïú Í≤ΩÎ°úÎ•º Î∞òÌôòÌïòÏßÄÎßå, apache2 ÏÑ§Ï†ïÏùÑ ÎßûÏ∂îÏñ¥   Ï£ºÏßÄ ÏïäÏïòÍ∏∞ ÎïåÎ¨∏Ïù¥Îã§.</p>
<p>Ï∑®ÏïΩÏ†êÏùÄ ÌôïÏû•Ïûê Í≤ÄÏÇ¨ Ïãú Î∞úÏÉùÌïúÎã§. Í∏∞Î≥∏Ï†ÅÏúºÎ°ú Ïù∏Ï¶ùÏù¥ Î∂àÌïÑÏöîÌïú js, css, png, jpgÏôÄ Í∞ôÏùÄ ÌååÏùºÏùÑ ÏöîÏ≤≠Ìï† Í≤ΩÏö∞ ÌôïÏû•ÏûêÎ•º Í≤ÄÏÇ¨ÌïòÏó¨ Ïù∏Ï¶ù Í≥ºÏ†ïÏùÑ ÏßÄÎÇòÏπòÎèÑÎ°ù ÎêòÏñ¥ÏûàÎã§. Í∑∏Îü¨ÎÇò <code>/js</code> ÏôÄ Í∞ôÏùÄ ÌòïÌÉúÎ°ú ÏöîÏ≤≠ Ïãú split Í≤∞Í≥ºÍ∞Ä <code>['js']</code> Í∞Ä ÎêòÍ∏∞ ÎïåÎ¨∏Ïóê Ïù∏Ï¶ù Î°úÏßÅÏùÑ Ïö∞ÌöåÌï† Ïàò ÏûàÎã§.</p>
<h4 id="flag">FLAG</h4>
<p><code>HCAMP{c4f5d41c69c57250471bc5bb9ddb3f77ed4237a2a8b235cff0aba458ccd2e5c3}</code></p>
<h3 id="Ìï©Í≤©Ïûê-Î∞úÌëú">Ìï©Í≤©Ïûê Î∞úÌëú</h3>
<blockquote>
<p>ÏïÑÍ∏∞Îã§Î¶¨Í≥†Í∏∞Îã§Î¶¨Îçò Îç∞Î™¨ÎåÄÌïôÍµê Ìï©Í≤©ÏûêÍ∞Ä Î∞úÌëúÎêòÏóàÏäµÎãàÎã§~</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#! /usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, render_template
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> request, redirect, url_for
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> wraps
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os<span style="color:#f92672">,</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> db <span style="color:#f92672">import</span> query
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>server <span style="color:#f92672">=</span> Flask(__name__)
</span></span><span style="display:flex;"><span>server<span style="color:#f92672">.</span>secret_key <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>urandom(<span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@server</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;index.html&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@server</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#39;/lookup&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;POST&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lookup</span>():
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;name&#34;</span>)
</span></span><span style="display:flex;"><span>    birth <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;birth&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># db has name, phone, candidate_no, birth, is_passed</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> (name <span style="color:#f92672">and</span> birth):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;result.html&#39;</span>, result<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> query(<span style="color:#e6db74">&#39;SELECT * FROM prob where name=&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34; and birth=&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;&#39;</span><span style="color:#f92672">.</span>format(name, birth))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;result.html&#39;</span>, result<span style="color:#f92672">=</span>result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    server<span style="color:#f92672">.</span>run(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;0.0.0.0&#39;</span>, debug<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p>Î¨∏Ï†ú ÎÇ¥ ÏÑúÎπÑÏä§Îäî nameÍ≥º birth ÌååÎùºÎØ∏ÌÑ∞Î•º ÌÜµÌï¥ POSTÎ°ú Ìï©Í≤©Ïûê Ï°∞ÌöåÎ•º ÏöîÏ≤≠Ìï† Ïàò ÏûàÎã§. Í∑∏Îü¨ÎÇò Ï°∞Ìöå Í≥ºÏ†ïÏóêÏÑú ÏÇ¨Ïö©ÎêòÎäî SELECT ÏøºÎ¶¨Ïóê ÌååÎùºÎØ∏ÌÑ∞Í∞Ä Í≤ÄÏ¶ù ÏóÜÏù¥ Î∞îÎ°ú ÏÇΩÏûÖÎêòÎ©¥ÏÑú SQL InjectionÏùÑ ÏàòÌñâÌï† Ïàò ÏûàÎã§. Îã§ÏùåÍ≥º Í∞ôÏù¥ Îã§ÏñëÌïú Î∞©ÏãùÏùò Ï†ëÍ∑ºÏùÑ ÌÜµÌï¥ Î¨∏Ï†úÎ•º Ìï¥Í≤∞Ìï† Ïàò ÏûàÎã§.</p>
<ul>
<li><code>&quot; union select 1, 2, 3, 4, group_concat(name) from prob#</code></li>
<li><code>&quot; or 1 limit 36,1#</code></li>
<li><code>&quot; or name like &quot;%HCAMP%&quot;#</code></li>
</ul>
<h4 id="flag-1">FLAG</h4>
<p><code>HCAMP{5D46BCE881C8E9EAAA547453D4E15A21}</code></p>
<h2 id="crypto">CRYPTO</h2>
<h3 id="really-safe-a">Really Safe A,,,</h3>
<blockquote>
<p>Ïù¥Í±∞Ïù¥Í±∞ Ï†ïÎßê ÏïàÏ†ÑÌïúÎç∞ ÌëúÌòÑÌï† Î∞©Î≤ïÏù¥ ÏóÜÎÑ§,,,</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> getPrime, bytes_to_long, long_to_bytes
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> gmpy2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> p <span style="color:#f92672">*</span> q
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">=</span> (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>divm(<span style="color:#ae81ff">1</span>, e, phi)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">padding</span>(msg):
</span></span><span style="display:flex;"><span>    total_length <span style="color:#f92672">=</span> len(msg) <span style="color:#f92672">+</span> (len(msg) <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> msg<span style="color:#f92672">.</span>ljust(total_length, <span style="color:#e6db74">&#39;=&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">really_secret_cipher</span>(plaintext):
</span></span><span style="display:flex;"><span>    cipher_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> padding(plaintext)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ptr <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(msg)<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>        M1 <span style="color:#f92672">=</span> bytes_to_long(msg[ptr:ptr<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>        C1 <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>powmod(M1, e, N)
</span></span><span style="display:flex;"><span>        M2 <span style="color:#f92672">=</span> bytes_to_long(msg[ptr<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>:ptr<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>]<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>        C2 <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>powmod(M2, e, N)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        super_C <span style="color:#f92672">=</span> C1 <span style="color:#f92672">*</span> C2
</span></span><span style="display:flex;"><span>        cipher_list<span style="color:#f92672">.</span>append(long_to_bytes(super_C)<span style="color:#f92672">.</span>hex())
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;.&#39;</span><span style="color:#f92672">.</span>join(cipher_list)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FLAG <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;HCAMP{******}&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    encrypted_flag <span style="color:#f92672">=</span> really_secret_cipher(FLAG)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;data.enc&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;FLAG : &#34;</span> <span style="color:#f92672">+</span> FLAG)
</span></span><span style="display:flex;"><span>        f<span style="color:#f92672">.</span>write(str(N) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">+</span> str(e) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">+</span> encrypted_flag)
</span></span></code></pre></div><p>Î¨∏Ï†ú Ïª®ÏÖâÏùÄ ÌäπÏ†ï Ïó∞ÏÇ∞ÏùÑ Ï∂îÍ∞ÄÌï¥ Ï†ïÎßê ÏïàÏ†ÑÌïú ÏïîÌò∏Ï≤¥Í≥ÑÎ•º ÎßåÎì§ÏóàÎã§Îäî ÎÇ¥Ïö©Ïù¥Îã§. ÏïàÏ†ÑÌïòÎã§Í≥† Ï£ºÏû•ÌïòÎäî ÏïîÌò∏Ï≤¥Í≥ÑÎäî Îã§ÏùåÍ≥º Í∞ôÎã§. ÏïîÌò∏ÌôîÌï† ÌèâÎ¨∏ÏóêÏÑú Ïïû 2bytes(M1)ÏôÄ Îí§ 2bytes(M2)Î•º Í∞ÅÍ∞Å ÏïîÌò∏Ìôî(C1, C2)Ìïú Îí§, Íµ¨Ìï¥ÏßÑ Îëê ÏïîÌò∏Î¨∏ÏùÑ Í≥±ÌïòÏó¨ <code>super_C</code>Î•º ÏÉùÏÑ±Ìï¥ÎÇ∏Îã§. Ïù¥Î†áÍ≤å ÎßåÎì§Ïñ¥ÏßÑ <code>super_C</code>Îäî Î¶¨Ïä§Ìä∏Ïóê Ï†ÄÏû•ÌïòÍ≥†, ÌèâÎ¨∏Ïùò ÌòÑÏû¨ ÏúÑÏπòÎ°úÎ∂ÄÌÑ∞ 2bytes Îí§Î∂ÄÌÑ∞ Îã§Ïãú Î°úÏßÅÏùÑ Î∞òÎ≥µÌïúÎã§. Í∞ÑÎã®ÌïòÍ≤å ÏòàÏãúÎ•º Îì§Î©¥ Îã§ÏùåÍ≥º Í∞ôÎã§.</p>
<pre tabindex="0"><code>ÌèâÎ¨∏ : &#34;THIS IS SECRET&#34;



Encrypt(&#34;TH&#34;)\*Encrypt(&#34;IS&#34;) -&gt; Ï†ÄÏû•

Encrypt(&#34;IS&#34;)\*Encrypt(&#34; I&#34;) -&gt; Ï†ÄÏû•

Encrypt(&#34; I&#34;)\*Encrypt(&#34;S &#34;) -&gt; Ï†ÄÏû•

...
</code></pre><p>Ïó¨Í∏∞ÏÑú ÏúÑ Î∞©ÏãùÏùò Ï∑®ÏïΩÏ†êÏùÄ Îëê ÏïîÌò∏Î¨∏Ïùò Í≥±Ïóê ÏûàÎã§. RSAÏóêÏÑú Îëê ÏïîÌò∏Î¨∏Ïùò Í≥±ÏùÄ ÌèâÎ¨∏ Í≥±Ïùò ÏïîÌò∏Î¨∏Í≥º Í∞ôÎã§.</p>
<p>$$ C1 * C2 = (M1^e\ mod\ N) * (M2^e\ mod\ N) $$
$$ = (M1^e * M2^e)\ mod N $$
$$ = (M1*M2)^e\ mod\ N $$</p>
<p>ÎòêÌïú, ÏΩîÎìúÎ•º ÌÜµÌï¥ ÌèâÎ¨∏Ïù¥ <code>HCAMP{</code> Î°ú ÏãúÏûëÌï®ÏùÑ Ïïå Ïàò ÏûàÎã§. Ïù¥Î•º ÌÜµÌï¥ Îí§ 2bytesÎ•º Î∏åÎ£®Ìä∏Ìè¨Ïä§ Í≥µÍ≤©ÏúºÎ°ú Ï∞æÏïÑÎÇº Ïàò ÏûàÎã§. Îã§Ïùå ÏΩîÎìúÎäî ÏúÑ Ï∑®ÏïΩÏ†êÏùÑ Ïù¥Ïö©Ìï¥ Î≥µÌò∏Ìôî ÌïòÎäî ÏΩîÎìúÏù¥Îã§.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> getPrime, bytes_to_long, long_to_bytes
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> gmpy2
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> binascii <span style="color:#f92672">import</span> unhexlify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bruteforce</span>(M1, super_C):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> b1 <span style="color:#f92672">in</span> string<span style="color:#f92672">.</span>printable:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> b2 <span style="color:#f92672">in</span> string<span style="color:#f92672">.</span>printable:
</span></span><span style="display:flex;"><span>            next_m <span style="color:#f92672">=</span> b1 <span style="color:#f92672">+</span> b2
</span></span><span style="display:flex;"><span>            M2 <span style="color:#f92672">=</span> bytes_to_long(next_m<span style="color:#f92672">.</span>encode()) 
</span></span><span style="display:flex;"><span>            guessed_super_C <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>powmod(M1 <span style="color:#f92672">*</span> M2, e, N)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">#print(guessed_super_C, super_C)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (guessed_super_C <span style="color:#f92672">==</span> super_C):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> M2
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">crack</span>(prev):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> long_to_bytes(prev)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> cipher <span style="color:#f92672">in</span> enc_list:
</span></span><span style="display:flex;"><span>        super_C <span style="color:#f92672">=</span> bytes_to_long(unhexlify(cipher)) <span style="color:#f92672">%</span> N
</span></span><span style="display:flex;"><span>        prev <span style="color:#f92672">=</span> bruteforce(prev, super_C)
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">+=</span> long_to_bytes(prev)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;[*] status : &#39;</span>, result)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> prev :
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;data.enc&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>seped_data_list <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N   <span style="color:#f92672">=</span> int(seped_data_list[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>e   <span style="color:#f92672">=</span> int(seped_data_list[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>enc_list <span style="color:#f92672">=</span> seped_data_list[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;.&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> crack(bytes_to_long(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;HC&#39;</span>))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;FLAG : &#34;</span> <span style="color:#f92672">+</span> flag<span style="color:#f92672">.</span>decode())
</span></span></code></pre></div><h4 id="flag-2">FLAG</h4>
<p><code>HCAMP{277a5a11b18251b2e34b484ca77d71fe84112d280b7a2d2da6319c7087d6a717}</code></p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/ctf/2020/vishwactf/" title="2022 Vishwactf"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/cve/" title="CVE" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1647877931"></script>
    <script src="/js/perfect-scrollbar.min.js?1647877931"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1647877931"></script>
    <script src="/js/jquery.sticky.js?1647877931"></script>
    <script src="/js/featherlight.min.js?1647877931"></script>
    <script src="/js/highlight.pack.js?1647877931"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1647877931"></script>
    <script src="/js/learn.js?1647877931"></script>
    <script src="/js/hugo-learn.js?1647877931"></script>
    
        
            <script src="/mermaid/mermaid.js?1647877931"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

