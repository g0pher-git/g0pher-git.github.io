<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.93.2" />
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>24th Hackingcamp Ctf :: </title>

    
    <link href="/css/nucleus.css?1647877931" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1647877931" rel="stylesheet">
    <link href="/css/hybrid.css?1647877931" rel="stylesheet">
    <link href="/css/featherlight.min.css?1647877931" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1647877931" rel="stylesheet">
    <link href="/css/auto-complete.css?1647877931" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1647877931" rel="stylesheet">
    <link href="/css/theme.css?1647877931" rel="stylesheet">
    <link href="/css/tabs.css?1647877931" rel="stylesheet">
    <link href="/css/hugo-theme.css?1647877931" rel="stylesheet">
    
    <link href="/css/theme-custom.css?1647877931" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1647877931"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/ctf/2020/24th-hackingcamp-ctf/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://o_o.jseung.me/">
   <img src="/images/jseung.png" alt="jseung.png">
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1647877931"></script>
<script type="text/javascript" src="/js/auto-complete.js?1647877931"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/o_o.jseung.me\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1647877931"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/ctf/" title="CTF" class="dd-item
        parent
        
        
        ">
      <a href="/ctf/">
          <b>ğŸš© </b>CTF
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ctf/2020/vishwactf/" title="2022 Vishwactf" class="dd-item ">
        <a href="/ctf/2020/vishwactf/">
        2022 Vishwactf
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ctf/2020/24th-hackingcamp-ctf/" title="24th Hackingcamp Ctf" class="dd-item active">
        <a href="/ctf/2020/24th-hackingcamp-ctf/">
        24th Hackingcamp Ctf
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/cve/" title="CVE" class="dd-item
        
        
        
        ">
      <a href="/cve/">
          <b>ğŸ¤  </b>CVE
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/tech/" title="HACKING TECHNIQUE" class="dd-item
        
        
        
        ">
      <a href="/tech/">
          <b>ğŸ‘»  </b>HACKING TECHNIQUE
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/tech/web/" title="web" class="dd-item
        
        
        
        ">
      <a href="/tech/web/">
          <b>0x01. </b>web
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/pwn/" title="pwn" class="dd-item
        
        
        
        ">
      <a href="/tech/pwn/">
          <b>0x02. </b>pwn
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/rev/" title="rev" class="dd-item
        
        
        
        ">
      <a href="/tech/rev/">
          <b>0x03. </b>rev
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/crypto/" title="crypto" class="dd-item
        
        
        
        ">
      <a href="/tech/crypto/">
          <b>0x04. </b>crypto
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/mobile/" title="mobile" class="dd-item
        
        
        
        ">
      <a href="/tech/mobile/">
          <b>0x05. </b>mobile
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/forensic/" title="forensic" class="dd-item
        
        
        
        ">
      <a href="/tech/forensic/">
          <b>0x06. </b>forensic
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/hardware/" title="hardware" class="dd-item
        
        
        
        ">
      <a href="/tech/hardware/">
          <b>0x07. </b>hardware
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/tech/network/" title="network" class="dd-item
        
        
        
        ">
      <a href="/tech/network/">
          <b>0x08. </b>network
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/tech/network/bgp-hijacking/" title="BGP Hijacking" class="dd-item ">
        <a href="/tech/network/bgp-hijacking/">
        BGP Hijacking
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://jseung.me"> Jaeseung Lee ğŸ‘»</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/g0pher98"><i class='fab fa-github'></i>  Github</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                    
                  <span id="toc-menu"><i class="fas fa-list-alt"></i> INDEX</span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'></a> > <a href='/ctf/'>CTF</a> > 24th Hackingcamp Ctf
          
        
          
        
          
        
                 
                  </span>
                  
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#web">WEB</a>
      <ul>
        <li><a href="#basic-auth">Basic Auth</a></li>
        <li><a href="#í•©ê²©ì-ë°œí‘œ">í•©ê²©ì ë°œí‘œ</a></li>
      </ul>
    </li>
    <li><a href="#crypto">CRYPTO</a>
      <ul>
        <li><a href="#really-safe-a">Really Safe A,,,</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              24th Hackingcamp Ctf
            </h1>
          

        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

<h2 id="web">WEB</h2>
<h3 id="basic-auth">Basic Auth</h3>
<blockquote>
<p>ì–´ë””ë¡œë“  ë¬¸~~~ ì€ ì ê²¨ìˆìŠµë‹ˆë‹¤. ì—´ì‡ ê°€ í•„ìš”í•˜ì‹ ê°€ìš”?</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#! /usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> request, url_for
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> wraps
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flag <span style="color:#f92672">import</span> FLAG 
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os<span style="color:#f92672">,</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>server <span style="color:#f92672">=</span> Flask(__name__)
</span></span><span style="display:flex;"><span>server<span style="color:#f92672">.</span>secret_key <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>urandom(<span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_auth</span>(f):
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@wraps</span>(f)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">func</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>        page <span style="color:#f92672">=</span> kwargs[<span style="color:#e6db74">&#39;page&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> page<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;.&#39;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#39;js&#39;</span>, <span style="color:#e6db74">&#39;css&#39;</span>, <span style="color:#e6db74">&#39;png&#39;</span>, <span style="color:#e6db74">&#39;jpg&#39;</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            auth <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>authorization
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> (auth <span style="color:#f92672">and</span> check_login(auth<span style="color:#f92672">.</span>username, auth<span style="color:#f92672">.</span>password)):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> (<span style="color:#e6db74">&#39;Wrong! who are you???ğŸ˜‘&#39;</span>, <span style="color:#ae81ff">401</span>, {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;WWW-Authenticate&#39;</span>: <span style="color:#e6db74">&#39;Basic realm=&#34;show me your id,pw&#34;&#39;</span>
</span></span><span style="display:flex;"><span>                })
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> func
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_login</span>(user_id, user_pw):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(url_for(<span style="color:#e6db74">&#39;static&#39;</span>, filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;account&#39;</span>)[<span style="color:#ae81ff">1</span>:], <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;:&#39;</span>)
</span></span><span style="display:flex;"><span>        admin_id <span style="color:#f92672">=</span> data[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        admin_pw <span style="color:#f92672">=</span> data[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> user_id <span style="color:#f92672">==</span> admin_id <span style="color:#f92672">and</span> user_pw <span style="color:#f92672">==</span> admin_pw:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@server</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Welcome! go to any page!&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@server</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#39;/&lt;page&gt;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@check_auth</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">flag</span>(page):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;.&#39;</span> <span style="color:#f92672">in</span> page:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> server<span style="color:#f92672">.</span>send_static_file(page)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> FLAG
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    server<span style="color:#f92672">.</span>run(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;0.0.0.0&#39;</span>)
</span></span></code></pre></div><p>ë¬¸ì œ ì½”ë“œë¥¼ ë³´ë©´ ë¡œê·¸ì¸ ì„±ê³µ í›„ dot(.)ì´ ì—†ëŠ” <code>/&lt;page&gt;</code> ì¦‰, ì•„ë¬´ í˜ì´ì§€ë‚˜ ì ‘ê·¼í•˜ë©´ í”Œë˜ê·¸ë¥¼ ì£¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹¤ì œë¡œ ì ‘ê·¼í•´ë³´ë©´ <code>check_auth()</code> decorator functionì— ì˜í•´ HTTP Basic Authenticationì„ ìš”êµ¬í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤. Basic Authenticationì— ì‚¬ìš©ë˜ëŠ” ê³„ì •ì€ <code>/static/account</code>ì— ì¡´ì¬í•˜ë©°, ì ‘ê·¼ ì‹œ ê·¸ ë‚´ìš©ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p>
<pre tabindex="0"><code>ThisIsNotFlagJustAdminID:ThisIsNotFlagJustAdminPassword
</code></pre><p>ìœ„ ë‚´ìš©ì„ ì´ìš©í•´ì„œ Basic Authentication ì¸ì¦ì„ ì‹œë„í•˜ë©´ ë¡œê·¸ì¸ì´ ì§„í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤. account íŒŒì¼ì— ì ‘ê·¼í•  ë•Œ ì‚¬ìš©í•œ <code>url_for</code> í•¨ìˆ˜ê°€ webrootë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ê²½ë¡œë¥¼ ë°˜í™˜í•˜ì§€ë§Œ, apache2 ì„¤ì •ì„ ë§ì¶”ì–´   ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ë‹¤.</p>
<p>ì·¨ì•½ì ì€ í™•ì¥ì ê²€ì‚¬ ì‹œ ë°œìƒí•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ì¸ì¦ì´ ë¶ˆí•„ìš”í•œ js, css, png, jpgì™€ ê°™ì€ íŒŒì¼ì„ ìš”ì²­í•  ê²½ìš° í™•ì¥ìë¥¼ ê²€ì‚¬í•˜ì—¬ ì¸ì¦ ê³¼ì •ì„ ì§€ë‚˜ì¹˜ë„ë¡ ë˜ì–´ìˆë‹¤. ê·¸ëŸ¬ë‚˜ <code>/js</code> ì™€ ê°™ì€ í˜•íƒœë¡œ ìš”ì²­ ì‹œ split ê²°ê³¼ê°€ <code>['js']</code> ê°€ ë˜ê¸° ë•Œë¬¸ì— ì¸ì¦ ë¡œì§ì„ ìš°íšŒí•  ìˆ˜ ìˆë‹¤.</p>
<h4 id="flag">FLAG</h4>
<p><code>HCAMP{c4f5d41c69c57250471bc5bb9ddb3f77ed4237a2a8b235cff0aba458ccd2e5c3}</code></p>
<h3 id="í•©ê²©ì-ë°œí‘œ">í•©ê²©ì ë°œí‘œ</h3>
<blockquote>
<p>ì•„ê¸°ë‹¤ë¦¬ê³ ê¸°ë‹¤ë¦¬ë˜ ë°ëª¬ëŒ€í•™êµ í•©ê²©ìê°€ ë°œí‘œë˜ì—ˆìŠµë‹ˆë‹¤~</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#! /usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, render_template
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> request, redirect, url_for
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> wraps
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os<span style="color:#f92672">,</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> db <span style="color:#f92672">import</span> query
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>server <span style="color:#f92672">=</span> Flask(__name__)
</span></span><span style="display:flex;"><span>server<span style="color:#f92672">.</span>secret_key <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>urandom(<span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@server</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;index.html&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@server</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#39;/lookup&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;POST&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lookup</span>():
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;name&#34;</span>)
</span></span><span style="display:flex;"><span>    birth <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;birth&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># db has name, phone, candidate_no, birth, is_passed</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> (name <span style="color:#f92672">and</span> birth):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;result.html&#39;</span>, result<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> query(<span style="color:#e6db74">&#39;SELECT * FROM prob where name=&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34; and birth=&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;&#39;</span><span style="color:#f92672">.</span>format(name, birth))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;result.html&#39;</span>, result<span style="color:#f92672">=</span>result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    server<span style="color:#f92672">.</span>run(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;0.0.0.0&#39;</span>, debug<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p>ë¬¸ì œ ë‚´ ì„œë¹„ìŠ¤ëŠ” nameê³¼ birth íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ POSTë¡œ í•©ê²©ì ì¡°íšŒë¥¼ ìš”ì²­í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ì¡°íšŒ ê³¼ì •ì—ì„œ ì‚¬ìš©ë˜ëŠ” SELECT ì¿¼ë¦¬ì— íŒŒë¼ë¯¸í„°ê°€ ê²€ì¦ ì—†ì´ ë°”ë¡œ ì‚½ì…ë˜ë©´ì„œ SQL Injectionì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ë‹¤ì–‘í•œ ë°©ì‹ì˜ ì ‘ê·¼ì„ í†µí•´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
<li><code>&quot; union select 1, 2, 3, 4, group_concat(name) from prob#</code></li>
<li><code>&quot; or 1 limit 36,1#</code></li>
<li><code>&quot; or name like &quot;%HCAMP%&quot;#</code></li>
</ul>
<h4 id="flag-1">FLAG</h4>
<p><code>HCAMP{5D46BCE881C8E9EAAA547453D4E15A21}</code></p>
<h2 id="crypto">CRYPTO</h2>
<h3 id="really-safe-a">Really Safe A,,,</h3>
<blockquote>
<p>ì´ê±°ì´ê±° ì •ë§ ì•ˆì „í•œë° í‘œí˜„í•  ë°©ë²•ì´ ì—†ë„¤,,,</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> getPrime, bytes_to_long, long_to_bytes
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> gmpy2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> p <span style="color:#f92672">*</span> q
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">=</span> (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>divm(<span style="color:#ae81ff">1</span>, e, phi)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">padding</span>(msg):
</span></span><span style="display:flex;"><span>    total_length <span style="color:#f92672">=</span> len(msg) <span style="color:#f92672">+</span> (len(msg) <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> msg<span style="color:#f92672">.</span>ljust(total_length, <span style="color:#e6db74">&#39;=&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">really_secret_cipher</span>(plaintext):
</span></span><span style="display:flex;"><span>    cipher_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> padding(plaintext)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ptr <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(msg)<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>        M1 <span style="color:#f92672">=</span> bytes_to_long(msg[ptr:ptr<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>        C1 <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>powmod(M1, e, N)
</span></span><span style="display:flex;"><span>        M2 <span style="color:#f92672">=</span> bytes_to_long(msg[ptr<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>:ptr<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>]<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>        C2 <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>powmod(M2, e, N)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        super_C <span style="color:#f92672">=</span> C1 <span style="color:#f92672">*</span> C2
</span></span><span style="display:flex;"><span>        cipher_list<span style="color:#f92672">.</span>append(long_to_bytes(super_C)<span style="color:#f92672">.</span>hex())
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;.&#39;</span><span style="color:#f92672">.</span>join(cipher_list)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FLAG <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;HCAMP{******}&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    encrypted_flag <span style="color:#f92672">=</span> really_secret_cipher(FLAG)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;data.enc&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;FLAG : &#34;</span> <span style="color:#f92672">+</span> FLAG)
</span></span><span style="display:flex;"><span>        f<span style="color:#f92672">.</span>write(str(N) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">+</span> str(e) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">+</span> encrypted_flag)
</span></span></code></pre></div><p>ë¬¸ì œ ì»¨ì…‰ì€ íŠ¹ì • ì—°ì‚°ì„ ì¶”ê°€í•´ ì •ë§ ì•ˆì „í•œ ì•”í˜¸ì²´ê³„ë¥¼ ë§Œë“¤ì—ˆë‹¤ëŠ” ë‚´ìš©ì´ë‹¤. ì•ˆì „í•˜ë‹¤ê³  ì£¼ì¥í•˜ëŠ” ì•”í˜¸ì²´ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ì•”í˜¸í™”í•  í‰ë¬¸ì—ì„œ ì• 2bytes(M1)ì™€ ë’¤ 2bytes(M2)ë¥¼ ê°ê° ì•”í˜¸í™”(C1, C2)í•œ ë’¤, êµ¬í•´ì§„ ë‘ ì•”í˜¸ë¬¸ì„ ê³±í•˜ì—¬ <code>super_C</code>ë¥¼ ìƒì„±í•´ë‚¸ë‹¤. ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ <code>super_C</code>ëŠ” ë¦¬ìŠ¤íŠ¸ì— ì €ì¥í•˜ê³ , í‰ë¬¸ì˜ í˜„ì¬ ìœ„ì¹˜ë¡œë¶€í„° 2bytes ë’¤ë¶€í„° ë‹¤ì‹œ ë¡œì§ì„ ë°˜ë³µí•œë‹¤. ê°„ë‹¨í•˜ê²Œ ì˜ˆì‹œë¥¼ ë“¤ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<pre tabindex="0"><code>í‰ë¬¸ : &#34;THIS IS SECRET&#34;



Encrypt(&#34;TH&#34;)\*Encrypt(&#34;IS&#34;) -&gt; ì €ì¥

Encrypt(&#34;IS&#34;)\*Encrypt(&#34; I&#34;) -&gt; ì €ì¥

Encrypt(&#34; I&#34;)\*Encrypt(&#34;S &#34;) -&gt; ì €ì¥

...
</code></pre><p>ì—¬ê¸°ì„œ ìœ„ ë°©ì‹ì˜ ì·¨ì•½ì ì€ ë‘ ì•”í˜¸ë¬¸ì˜ ê³±ì— ìˆë‹¤. RSAì—ì„œ ë‘ ì•”í˜¸ë¬¸ì˜ ê³±ì€ í‰ë¬¸ ê³±ì˜ ì•”í˜¸ë¬¸ê³¼ ê°™ë‹¤.</p>
<p>$$ C1 * C2 = (M1^e\ mod\ N) * (M2^e\ mod\ N) $$
$$ = (M1^e * M2^e)\ mod N $$
$$ = (M1*M2)^e\ mod\ N $$</p>
<p>ë˜í•œ, ì½”ë“œë¥¼ í†µí•´ í‰ë¬¸ì´ <code>HCAMP{</code> ë¡œ ì‹œì‘í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ë’¤ 2bytesë¥¼ ë¸Œë£¨íŠ¸í¬ìŠ¤ ê³µê²©ìœ¼ë¡œ ì°¾ì•„ë‚¼ ìˆ˜ ìˆë‹¤. ë‹¤ìŒ ì½”ë“œëŠ” ìœ„ ì·¨ì•½ì ì„ ì´ìš©í•´ ë³µí˜¸í™” í•˜ëŠ” ì½”ë“œì´ë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> getPrime, bytes_to_long, long_to_bytes
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> gmpy2
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> binascii <span style="color:#f92672">import</span> unhexlify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bruteforce</span>(M1, super_C):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> b1 <span style="color:#f92672">in</span> string<span style="color:#f92672">.</span>printable:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> b2 <span style="color:#f92672">in</span> string<span style="color:#f92672">.</span>printable:
</span></span><span style="display:flex;"><span>            next_m <span style="color:#f92672">=</span> b1 <span style="color:#f92672">+</span> b2
</span></span><span style="display:flex;"><span>            M2 <span style="color:#f92672">=</span> bytes_to_long(next_m<span style="color:#f92672">.</span>encode()) 
</span></span><span style="display:flex;"><span>            guessed_super_C <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>powmod(M1 <span style="color:#f92672">*</span> M2, e, N)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">#print(guessed_super_C, super_C)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (guessed_super_C <span style="color:#f92672">==</span> super_C):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> M2
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">crack</span>(prev):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> long_to_bytes(prev)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> cipher <span style="color:#f92672">in</span> enc_list:
</span></span><span style="display:flex;"><span>        super_C <span style="color:#f92672">=</span> bytes_to_long(unhexlify(cipher)) <span style="color:#f92672">%</span> N
</span></span><span style="display:flex;"><span>        prev <span style="color:#f92672">=</span> bruteforce(prev, super_C)
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">+=</span> long_to_bytes(prev)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;[*] status : &#39;</span>, result)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> prev :
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;data.enc&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>seped_data_list <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N   <span style="color:#f92672">=</span> int(seped_data_list[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>e   <span style="color:#f92672">=</span> int(seped_data_list[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>enc_list <span style="color:#f92672">=</span> seped_data_list[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;.&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> crack(bytes_to_long(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;HC&#39;</span>))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;FLAG : &#34;</span> <span style="color:#f92672">+</span> flag<span style="color:#f92672">.</span>decode())
</span></span></code></pre></div><h4 id="flag-2">FLAG</h4>
<p><code>HCAMP{277a5a11b18251b2e34b484ca77d71fe84112d280b7a2d2da6319c7087d6a717}</code></p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/ctf/2020/vishwactf/" title="2022 Vishwactf"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/cve/" title="CVE" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1647877931"></script>
    <script src="/js/perfect-scrollbar.min.js?1647877931"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1647877931"></script>
    <script src="/js/jquery.sticky.js?1647877931"></script>
    <script src="/js/featherlight.min.js?1647877931"></script>
    <script src="/js/highlight.pack.js?1647877931"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1647877931"></script>
    <script src="/js/learn.js?1647877931"></script>
    <script src="/js/hugo-learn.js?1647877931"></script>
    
        
            <script src="/mermaid/mermaid.js?1647877931"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

